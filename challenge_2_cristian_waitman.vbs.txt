Sub multiple_year_stock_data()' Create a variable to hold the counterDim i As Long' Set an initial variable for holding the tickerDim Ticker As String' Set a variables for stock pricesDim open_value As DoubleDim close_value As DoubleDim quarterly_change As DoubleDim percent_change As Double' create lookfor every worksheetDim ws As WorksheetFor Each ws In Worksheets' Determine the last row with dataDim LastRow As LongLastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row' name columns sumarry tablesws.Cells(1, 9).Value = "Ticker"ws.Cells(1, 10).Value = "Quarterly Change"ws.Cells(1, 11).Value = "Percent Change"ws.Cells(1, 12).Value = "Total Stock Volume"' Set an initial variable for holding the total stock value per tickerDim Total_Stock_Volume As DoubleTotal_Stock_Volume = 0' Keep track of the location for each ticker in the summary table  Dim Summary_Table_Row As Long  Summary_Table_Row = 2 ' Loop through all tickersFor i = 2 To LastRow   ' Check if we are still within the ticker, if we are not...If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then   Ticker = ws.Cells(i, 1).Value   ' Set the ticker name   open_value = ws.Cells(i - (ws.Cells(i, 1).End(xlUp).Row - 1), 3).Value   ' Set open price   close_value = ws.Cells(i, 6).Value   ' Set close price  ' calculate quarterly change & percent change    quarterly_change = close_value - open_value        If open_value <> 0 Then             percent_change = quarterly_change / open_value          Else             percent_change = 0         End If   ' Add to the total stock volume   Total_Stock_Volume = Total_Stock_Volume + ws.Cells(i, 7).Value ' Print the ticker in the summary table   ws.Range("I" & Summary_Table_Row).Value = Ticker      ' Print the quarterly change in the summary table   ws.Range("J" & Summary_Table_Row).Value = quarterly_change      ' Print the percent change to the summary table   ws.Range("K" & Summary_Table_Row).Value = percent_change      ' Print the total stock volume to the summary table   ws.Range("L" & Summary_Table_Row).Value = Total_Stock_Volume           'background formating quaterly change    If ws.Cells(Summary_Table_Row, 10).Value > 0 Then          ws.Cells(Summary_Table_Row, 10).Interior.ColorIndex = 4        ElseIf ws.Cells(Summary_Table_Row, 10).Value < 0 Then          ws.Cells(Summary_Table_Row, 10).Interior.ColorIndex = 3        Else          ws.Cells(Summary_Table_Row, 10).Interior.ColorIndex = 2    End If        ' formating Percentage change   ws.Range("K" & Summary_Table_Row).NumberFormat = "0.00%"      ' Add one to the summary table row   Summary_Table_Row = Summary_Table_Row + 1      ' Reset the total stock value   Total_Stock_Volume = 0       ' if the cell inmediately following a row is the same ticker...   Else  ' Add to the total stock volume   Total_Stock_Volume = Total_Stock_Volume + Cells(i, 7).Value   End IfNext i'Set variables for second summary tableDim greatest_increase As DoubleDim greatest_decrease As DoubleDim greatest_total_volume As LongDim greatest_increase_ticker As StringDim greatest_decrease_ticker As StringDim greatest_volume_ticker As String'Set initial values for summary table 2 variables    greatest_increase = -9999999 ' Initialize to a very low number    greatest_decrease = 9999999  ' Initialize to a very high number    greatest_volume = 0Dim j As Long        For j = 2 To Summary_Table_Row - 1            ' Check for greatest % increase            If ws.Cells(j, 11).Value > greatest_increase Then                greatest_increase = ws.Cells(j, 11).Value                greatest_increase_ticker = ws.Cells(j, 9).Value            End If                        ' Check for greatest % decrease            If ws.Cells(j, 11).Value < greatest_decrease Then                greatest_decrease = ws.Cells(j, 11).Value                greatest_decrease_ticker = ws.Cells(j, 9).Value            End If                        ' Check for greatest total stock volume            If ws.Cells(j, 12).Value > greatest_volume Then                greatest_volume = ws.Cells(j, 12).Value                greatest_volume_ticker = ws.Cells(j, 9).Value            End If        Next j  ' Print the variables in the summary table 2        ws.Cells(2, 15).Value = "Greatest % Increase"        ws.Cells(3, 15).Value = "Greatest % Decrease"        ws.Cells(4, 15).Value = "Greatest Total Volume"        ws.Cells(1, 16).Value = "Ticker"        ws.Cells(1, 17).Value = "Value"           ' Print greatest increase values        ws.Cells(2, 16).Value = greatest_increase_ticker        ws.Cells(2, 17).Value = greatest_increase       ' Print greatest decrease values        ws.Cells(3, 16).Value = greatest_decrease_ticker        ws.Cells(3, 17).Value = greatest_decrease            ' Print greatest reatest total volume values        ws.Cells(4, 16).Value = greatest_volume_ticker        ws.Cells(4, 17).Value = greatest_volume                             ' formating greatestcrease and decrease   ws.Cells(2, 17).NumberFormat = "0.00%"   ws.Cells(3, 17).NumberFormat = "0.00%"Next wsEnd Sub